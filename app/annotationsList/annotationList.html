<div  class="container_12" cg-busy="resultsPromise" ng-controller="AnnotationListCtrl">
<!-- Buttons -->
<p class="buttons-under-tabs">
  <button class="btn quickgo-btn icon-functional" ng-click="toggleCustomiseContainer()"
  data-icon="s">Customise</button>
  <button class="btn quickgo-btn icon-functional" ng-click="download()" data-icon="=">Download</button>
  <span class="pagination-text"><strong>{{totalItems}}</strong> annotations</strong></span>
</p>

<div id="customiseColumns" class="animate-show" ng-hide="customiseColumnsContainer">
<span class="icon-functional customColsClose" ng-click="toggleCustomiseContainer()" data-icon="x"></span>

  <div id="default">
    <h3>Default Columns</h3>
    <div class="customCols">
      <input type="checkbox" ng-click="colGeneProduct = !colGeneProduct" checked> Gene Product<br/>
      <input type="checkbox" ng-click="colSymbol = !colSymbol" checked> Symbol<br/>
      <input type="checkbox" ng-click="colQualifier = !colQualifier" checked> Qualifier<br/>
      <input type="checkbox" ng-click="colGOIdentifier = !colGOIdentifier" checked> GO Term<br/>
      <input type="checkbox" ng-click="colEvidence = !colEvidence" checked> Evidence<br/>
    </div>
    <div class="customCols">
      <input type="checkbox" ng-click="colReference = !colReference" checked> Reference<br/>
      <input type="checkbox" ng-click="colWith = !colWith" checked> With / From<br/>
      <input type="checkbox" ng-click="colTaxon = !colTaxon" checked> Taxon<br/>
      <input type="checkbox" ng-click="colAssignedBy = !colAssignedBy" checked> Assigned By<br/>
      <input type="checkbox" ng-click="colAnnotationExtension = !colAnnotationExtension" checked> Annotation Extension<br/>
    </div>
  </div>

  <div id="extras">
    <h3>Additional Columns</h3>
    <div class="customCols">
      <input type="checkbox" ng-click="colDatabase = !colDatabase"> Database<br/>
      <input type="checkbox" ng-click="colDate = !colDate"> Date<br/>
      <input type="checkbox" ng-click="colName = !colName"> Name<br/>
      <input type="checkbox" ng-click="colSynonym = !colSynonym"> Synonym<br/>
      <input type="checkbox" ng-click="colType = !colType"> Type<br/>
    </div>
    <div class="customCols">
      <input type="checkbox" ng-click="colTaxonName = !colTaxonName"> Taxon Name<br/>
    </div>
  </div>

</div>

<!-- Results -->
<!--
The following table uses a plugin to allow the dragging and dropping of columns by the user.
"object-table.js" is the script.
Github: https://github.com/ekokotov/object-table
Documentation: http://ekokotov.github.io/object-table/samples.html#/

The HTML code in this table has been changed to explicitly work in this plugin
Author: Mark Bingley
Date: September 2016
 -->
<div>

<table id="assignedByCount" class="two-colours results-table"
object-table
drag-columns="true"
data="annotations"
headers="stuff"
fields="stuff"
paging="false"
display="25"
search="false"
select="false">
    <thead>
  <tr>

      <th allow-drag ng-show="$owner.colGeneProduct">Gene Product</th>
      <th allow-drag ng-show="$owner.colSymbol">Symbol</th>
      <th allow-drag ng-show="$owner.colQualifier">Qualifier</th>
      <th allow-drag ng-show="$owner.colGOIdentifier && $owner.showSlimColumns">Slimmed GO Term</th>
      <th allow-drag ng-show="$owner.colGOIdentifier"><span ng-show="$owner.showSlimColumns">Original </span>GO Term</th>
      <th allow-drag ng-show="$owner.colEvidence">Evidence</th>
      <th allow-drag ng-show="$owner.colReference">Reference</th>
      <th allow-drag ng-show="$owner.colWith">With / From</th>
      <th allow-drag ng-show="$owner.colTaxon">Taxon</th>
      <th allow-drag ng-show="$owner.colAssignedBy">Assigned By</th>
      <th allow-drag ng-show="$owner.colAnnotationExtension">Annotation Extension</th>
      <th allow-drag ng-show="$owner.colDatabase">Database</th>
      <th allow-drag ng-show="$owner.colDate">Date</th>
      <th allow-drag ng-show="$owner.colName">Name</th>
      <th allow-drag ng-show="$owner.colSynonym">Synonym</th>
      <th allow-drag ng-show="$owner.colType">Type</th>
      <th allow-drag ng-show="$owner.colTaxonName">Taxon Name</th>
      <th allow-drag ng-show="$owner.colSequence">Sequence</th>

  </tr>
      </thead>
  <tbody ng-non-bindable>

<tr >

<td class="td-no-icon" ng-show="$owner.colGeneProduct">
      <a ng-click="$owner.followLinkToEntry(item.geneProductId, item.geneProductId)"
       target="_blank">
        {{::item.geneProductId}}
      </a>
</td>
<td class="td-no-icon" ng-show="$owner.colSymbol">{{::item.symbol}}</td>
<td class="td-no-icon" ng-show="$owner.colQualifier">{{::item.qualifier}}</td>

<td ng-show="$owner.showSlimColumns && $owner.colGOIdentifier" class="text-nowrap">
  <term-line id="item.originalTermId" aspect="item.originalAspect" obsolete="item.isObsolete" name="item.goTermName"></term-line>
</td>

<td class="text-nowrap" ng-show="$owner.colGOIdentifier">
  <div class="go-term">
    <term-line id="item.goId" aspect="item.goAspect" obsolete="item.isObsolete" name="item.goTermName"></term-line>
  </div>
  <div ng-repeat="slimRepeat in ::item.slimsList" class="go-term slim-repeat">
    <term-line id="slimRepeat.goId" aspect="slimRepeat.aspect" obsolete="slimRepeat.isObsolete" name="slimRepeat.termName"></term-line>
  </div>
</td>

<td class="text-nowrap" ng-show="$owner.colEvidence">
  <term-line id="item.evidenceCode" name="item.goEvidence"></term-line>
  (<a class="quickgo-link" href="http://geneontology.org/page/guide-go-evidence-codes#{{::item.goEvidence | lowercase}}" target="_blank">{{::item.goEvidence}}</a>)
</td>

<td class="td-no-icon" ng-show="$owner.colReference">
    <a class="quickgo-link" ng-click="$owner.followLinkToEntry(item.reference)" target="_blank">
        {{::item.reference}}
    </a>
</td>

<td class="td-no-icon" ng-show="$owner.colWith">
  <div ng-repeat="item in item.withFrom">
    <div ng-repeat="resource in item.connectedXrefs" class="text-center"><a class="quickgo-link ellipsis" ng-click="$owner.followLinkToEntry(resource.db, resource.id)" target="_blank">{{resource.db}}:{{resource.id}}</a></div>
    <div class="text-center">
      <strong ng-show="!$last">OR</strong>
    </div>
  </div>
</td>

    <td class="td-no-icon" ng-show="$owner.colTaxon">
        <a class="quickgo-link selectable" ng-click="$owner.followLinkToEntry(item.taxonId, 'TAXON')" target="_blank">
            {{::item.taxonId}}
        </a>
    </td>
    <td class="td-no-icon" ng-show="$owner.colAssignedBy"><a class="quickgo-link selectable" ng-click="$owner.followLinkToGeneric(item.assignedBy)">{{::item.assignedBy}}</a></td>
    <td class="td-no-icon" ng-show="$owner.colAnnotationExtension">
      <div ng-repeat="item in item.extensions">
        <div ng-repeat="resource in item.connectedXrefs" class="text-center">
          <a href="https://github.com/geneontology/annotation_extensions/blob/master/doc/{{resource.qualifier}}.md" target="_blank">{{resource.qualifier}}(<a ng-click="$owner.followLinkToEntry(resource.db, resource.id)" target="_blank">{{resource.db}}:{{resource.id}} {{$owner.olsxrefs[resource.db + ':' + resource.id]}}</a>)
        </div>
        <div class="text-center">
          <strong ng-show="!$last">OR</strong>
        </div>
      </div>
    </td>

    <td ng-show="$owner.colDatabase">{{::$owner.gpMapping[item.geneProductSimpleId].database}}</td>
    <td ng-show="$owner.colDate">{{::item.date | limitTo : 4}}/{{::item.date | limitTo : 2 : 4}}/{{::item.date | limitTo : 2 : 6}}
    </td>

    <td ng-show="$owner.colName">{{::$owner.gpMapping[item.geneProductSimpleId].name}}</td>
    <td ng-show="$owner.colSynonym">{{::$owner.gpMapping[item.geneProductSimpleId].synonyms.join()}}</td>
    <td ng-show="$owner.colType">{{::$owner.gpMapping[item.geneProductSimpleId].type}}</td>
    <td ng-show="$owner.colTaxonName">{{::$owner.taxaMapping[item.taxonId].scientificName}}</td>
    <td ng-show="$owner.colSequence">{{::item.sequence}}</td>

        <td class="td-no-icon" ng-if="colAnnotationExtension">
          <span ng-if="annotation.extensions">
            <a ng-click="showAnnotationExtension(annotation.extensions)">
              {{annotation.extensions | shortenStringFilter}}
            </a>
          </span>
        </td>

    </tr>

</tbody>
    </table>

    <uib-pagination total-items="goList.numberOfHits" max-size="5" rotate="false" ng-model="currentPage"
  items-per-page="maxSize" ng-change="pageChanged()"></uib-pagination>

  </div>
  <!-- if there are no results tell the user explicitly -->
  <div ng-show="goList.numberOfHits == 0" class="jumbotron">
    <h4>No matching annotations have been found</h4>
  </div>

  <div class="clearfix"></div>

  <!-- Dynamicaly inserted tootltips for column headings -->
  <script type="text/ng-template" id="colDatabase.html"><span>The souce database of the annotation</span></script>
  <script type="text/ng-template" id="colGeneProductID.html"><span>The sequence IDs that have been annotated with GO Terms.</span></script>
  <script type="text/ng-template" id="colSymbol.html"><span>The symbols corresponding to the Gene Product ID. An officially approved gene symbol when available or other gene symbols or locus names.</span></script>
  <script type="text/ng-template" id="colQualifier.html"><span>Defines the relationship between Gene product and GO term.</span></script>
  <script type="text/ng-template" id="colGOIdentifier.html"><span>The unique, stable identifier of the GO term.</span></script>
  <script type="text/ng-template" id="colGOTermName.html"><span>The GO term name corresponding to the GO Identifier.</span></script>
  <script type="text/ng-template" id="colAspect.html"><span>The ontology to which <br />the GO term belongs:<br />F (Molecular Function)<br />P (Biological Process)<br />C (Cellular Component)</span></script>
  <script type="text/ng-template" id="colEvidence.html"><span>GO terms are assigned to proteins based on different evidence. This is represented by an evidence code.</span></script>
  <script type="text/ng-template" id="colReference.html"><span>A PubMed reference or a GO_REF identifier which contains either the data supporting the annotation or details of the electronic method applied to generate the annotation.</span></script>
  <script type="text/ng-template" id="colWith.html"><span>An additional ID to support annotations using certain evidence codes (including IEA, IPI, IGI, IC and ISS evidences). E.g. UniProtKB:O00341, InterPro:IPROO1878 …</span></script>
  <script type="text/ng-template" id="colTaxon.html"><span>The taxonomic ID for the species being annotated.</span></script>
  <script type="text/ng-template" id="colAssignedBy.html"><span>The database which created the annotation. The GO annotation may not be copied without acknowledgement of the data source.</span></script>
  <script type="text/ng-template" id="colAnnotationExtension.html"><span>Annotation Extension</span></script>
  <script type="text/ng-template" id="colOrigID.html"><span>The orginal GO ID</span></script>
  <script type="text/ng-template" id="colOrigName.html"><span>Original name of the slim</span></script>
