<div class="container_12" cg-busy="resultsPromise" ng-controller="AnnotationListCtrl">
  <!-- Buttons -->
  <p class="buttons-under-tabs">
    <button class="btn quickgo-btn icon-functional" ng-click="customiseColumnsContainer = !customiseColumnsContainer" data-icon="s">Customise</button>
    <button class="btn quickgo-btn icon-functional" ng-click="download()" data-icon="=">Download</button>
    <span class="pagination-text"><strong>{{totalItems}}</strong> annotations</strong></span>
  </p>

  <div class="column-selector" class="animate-show" ng-show="customiseColumnsContainer">
    <span class="icon-functional column-selector__close" ng-click="customiseColumnsContainer = !customiseColumnsContainer" data-icon="x"></span>
    <h3>Choose columns</h3>
    <div class="column-selector__columns">
      <p ng-repeat="column in columns">
        <label>
          <input type="checkbox" ng-model="column.visible"> {{column.label}}
        </label>
      </p>
    </div>
  </div>

  <div>
    <table id="assignedByCount" class="two-colours results-table">
      <thead>
        <tr>
          <th ng-repeat="column in columns" ng-show="column.visible">{{column.label}}</th>
          <!--      <th  ng-show="columns['goIdentifier'].visible && showSlimColumns">Slimmed GO Term</th>-->
        </tr>
      </thead>
      <tbody>

        <tr ng-repeat="item in annotations">
          <td ng-show="columns['geneProduct'].visible"><a ng-click="followLinkToEntry(item.geneProductId, item.geneProductId)" target="_blank">
        {{item.geneProductId}}</a></td>
          <td ng-show="columns['symbol'].visible">{{item.symbol}}</td>
          <td ng-show="columns['qualifier'].visible">{{item.qualifier}}</td>

          <td ng-show="showSlimColumns && columns['goIdentifier'].visible" class="text-nowrap">
            <term-line id="item.originalTermId" aspect="item.originalAspect" obsolete="item.isObsolete" name="item.goTermName"></term-line>
          </td>

          <td class="text-nowrap" ng-show="columns['goIdentifier'].visible">
            <div class="go-term">
              <term-line id="item.goId" aspect="item.goAspect" obsolete="item.isObsolete" name="item.goTermName"></term-line>
            </div>
            <div ng-repeat="slimRepeat in item.slimsList" class="go-term slim-repeat">
              <term-line id="slimRepeat.goId" aspect="slimRepeat.aspect" obsolete="slimRepeat.isObsolete" name="slimRepeat.termName"></term-line>
            </div>
          </td>

          <td class="text-nowrap" ng-show="columns['evidence'].visible">
            <term-line id="item.evidenceCode" name="item.goEvidence"></term-line>
          </td>

          <td ng-show="columns['reference'].visible">
            <a class="quickgo-link" ng-click="followLinkToEntry(item.reference)" target="_blank">{{item.reference}}</a>
          </td>

          <td ng-show="columns['withFrom'].visible">
            <div ng-repeat="item in item.withFrom">
              <div ng-repeat="resource in item.connectedXrefs" class="text-center"><a class="quickgo-link ellipsis" ng-click="followLinkToEntry(resource.db, resource.id)" target="_blank">{{resource.db}}:{{resource.id}}</a></div>
              <div class="text-center">
                <strong ng-show="!$last">OR</strong>
              </div>
            </div>
          </td>

          <td ng-show="columns['taxon'].visible">
            <a class="quickgo-link selectable" ng-click="followLinkToEntry(item.taxonId, 'TAXON')" target="_blank">{{item.taxonId}}</a>
          </td>
          <td ng-show="columns['assignedBy'].visible"><a class="quickgo-link selectable" ng-click="followLinkToGeneric(item.assignedBy)">{{item.assignedBy}}</a></td>
          <td ng-show="columns['annotationExtension'].visible">
            <div ng-repeat="item in item.extensions">
              <div ng-repeat="resource in item.connectedXrefs" class="text-center">
                <a href="https://github.com/geneontology/annotation_extensions/blob/master/doc/{{resource.qualifier}}.md" target="_blank">{{resource.qualifier}}(<a ng-click="followLinkToEntry(resource.db, resource.id)" target="_blank">{{resource.db}}:{{resource.id}} {{olsxrefs[resource.db + ':' + resource.id]}}</a>)
              </div>
              <div class="text-center">
                <strong ng-show="!$last">OR</strong>
              </div>
            </div>
          </td>

          <td ng-show="columns['database'].visible">{{gpMapping[item.geneProductSimpleId].database}}</td>
          <td ng-show="columns['date'].visible">{{item.date | limitTo : 4}}/{{item.date | limitTo : 2 : 4}}/{{item.date | limitTo : 2 : 6}}
          </td>

          <td ng-show="columns['name'].visible">{{gpMapping[item.geneProductSimpleId].name}}</td>
          <td ng-show="columns['synonym'].visible">{{gpMapping[item.geneProductSimpleId].synonyms.join()}}</td>
          <td ng-show="columns['type'].visible">{{gpMapping[item.geneProductSimpleId].type}}</td>
          <td ng-show="columns['taxonName'].visible">{{taxaMapping[item.taxonId].scientificName}}</td>
          <td ng-show="columns['sequence'].visible">{{item.sequence}}</td>

          <td ng-if="colAnnotationExtension">
            <span ng-if="annotation.extensions">
            <a ng-click="showAnnotationExtension(annotation.extensions)">{{annotation.extensions | shortenStringFilter}}</a>
          </span>
          </td>

        </tr>

      </tbody>
    </table>

    <uib-pagination total-items="goList.numberOfHits" max-size="5" rotate="false" ng-model="currentPage" items-per-page="maxSize" ng-change="pageChanged()"></uib-pagination>

  </div>
  <!-- if there are no results tell the user explicitly -->
  <div ng-show="goList.numberOfHits == 0" class="jumbotron">
    <h4>No matching annotations have been found</h4>
  </div>

  <div class="clearfix"></div>

  <!-- Dynamicaly inserted tootltips for column headings -->
  <script type="text/ng-template" id="colDatabase.html"><span>The souce database of the annotation</span></script>
  <script type="text/ng-template" id="colGeneProductID.html"><span>The sequence IDs that have been annotated with GO Terms.</span></script>
  <script type="text/ng-template" id="colSymbol.html"><span>The symbols corresponding to the Gene Product ID. An officially approved gene symbol when available or other gene symbols or locus names.</span></script>
  <script type="text/ng-template" id="colQualifier.html"><span>Defines the relationship between Gene product and GO term.</span></script>
  <script type="text/ng-template" id="colGOIdentifier.html"><span>The unique, stable identifier of the GO term.</span></script>
  <script type="text/ng-template" id="colGOTermName.html"><span>The GO term name corresponding to the GO Identifier.</span></script>
  <script type="text/ng-template" id="colAspect.html"><span>The ontology to which <br />the GO term belongs:<br />F (Molecular Function)<br />P (Biological Process)<br />C (Cellular Component)</span></script>
  <script type="text/ng-template" id="colEvidence.html"><span>GO terms are assigned to proteins based on different evidence. This is represented by an evidence code.</span></script>
  <script type="text/ng-template" id="colReference.html"><span>A PubMed reference or a GO_REF identifier which contains either the data supporting the annotation or details of the electronic method applied to generate the annotation.</span></script>
  <script type="text/ng-template" id="colWith.html"><span>An additional ID to support annotations using certain evidence codes (including IEA, IPI, IGI, IC and ISS evidences). E.g. UniProtKB:O00341, InterPro:IPROO1878 â€¦</span></script>
  <script type="text/ng-template" id="colTaxon.html"><span>The taxonomic ID for the species being annotated.</span></script>
  <script type="text/ng-template" id="colAssignedBy.html"><span>The database which created the annotation. The GO annotation may not be copied without acknowledgement of the data source.</span></script>
  <script type="text/ng-template" id="colAnnotationExtension.html"><span>Annotation Extension</span></script>
  <script type="text/ng-template" id="colOrigID.html"><span>The orginal GO ID</span></script>
  <script type="text/ng-template" id="colOrigName.html"><span>Original name of the slim</span></script>